<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blog Home</title>
  <link rel="stylesheet" href="/home.css" />
</head>
<body>

  <nav>
    <a href="/posts/add" class="nav-btn">Write New Blog</a>
    <% if (decode) { %>
      <a href="/users/logout" class="nav-btn">Logout</a>
    <% } else { %>
      <a href="/users/login" class="nav-btn">Login</a>
    <% } %>
  </nav>

  <div class="filter">
    <form action="/" method="get">
      <select name="category">
        <option value="">All Categories</option>
        <option value="technology" <%= queryCategory === 'technology' ? 'selected' : '' %>>Technology</option>
        <option value="lifestyle" <%= queryCategory === 'lifestyle' ? 'selected' : '' %>>Lifestyle</option>
        <option value="travel" <%= queryCategory === 'travel' ? 'selected' : '' %>>Travel</option>
        <option value="food" <%= queryCategory === 'food' ? 'selected' : '' %>>Food</option>
      </select>
      <button type="submit">Apply Filter</button>
    </form>
  </div>

  <div class="container">
    <% if (!posts || posts.length === 0) { %>
      <p style="text-align:center; padding: 20px;">No blog posts found for this category.</p>
    <% } else { %>
      <% posts.forEach(blog => { %>
        <div class="card">
          <img src="<%= blog.image %>" alt="Blog Image" />
          <div class="bottom">
            <h2><%= blog.title %></h2>
            <p><%= blog.snippet %></p>
            <p><em>By <%= blog.author %> | <%= new Date(blog.date).toLocaleDateString() %></em></p>

            <div class="actions">
              <a href="/posts/detail/<%= blog._id %>">Full View</a>
            </div>
          </div>
        </div>
      <% }) %>
    <% } %>
  </div>

</body>
</html>
